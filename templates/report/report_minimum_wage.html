{% extends 'report/base.html' %}

{% block content %}
<form class="form" onsubmit='return formsubmit();'>
    <h1>최저임금 미준수</h1>
    제 이름은
    <div class="validation">
      <input class="form-control" name="name" id="name" type="text" placeholder="이름" data-msg-required='이름을 작성해주세요.' required>
    </div>
    입니다.

    저는
    <div class="validation">
      <input class="form-control" name="place" id="place" type="text" placeholder="지역 + 가게이름 (ex. 서울시 마포구 싱싱청과)" data-msg-required='상호명을 작성해주세요.' required>
    </div>
     에서

    <div class="validation">
      <input type='text' class='form-control' name='daterange' required>
    </div>
    까지 일을 했습니다.

    총
    <div class="validation">
      <input class="form-control" name='total_time' id="total_time" type="text" placeholder="총 일한 시간" digits="true" data-msg-digits='일한 시간은 숫자로만 작성해주세요.' data-msg-required='일한 시간을 작성해주세요.' required>
    </div>
    시간을 일했습니다.
    그런데 제가 받은 액수는 총
    <div class="validation">
      <input class="form-control" name="take" id="take" type="text" placeholder="받은 금액" digits="true" data-msg-digits='받은 금액은 숫자로만 작성해주세요.' data-msg-required='받은 금액을 작성해주세요.' required>
    </div>
    원입니다.
    <div class="form-group">
      <input type="submit" class="btn btn-primary" value="submit"/>
    </div>
</form>

<script>
    var format = 'YYYY년 M월 D일';
    var start = moment().format(format);
    var end = moment().format(format);

    jQuery.validator.setDefaults({
      success: 'valid'
    })
    $('form.form').validate({
      errorPlacement: function(error, element) {
        error.addClass('help-block');
        error.insertAfter(element);
      },
      highlight: function(element, errorClass) {
        $(element).parents('.validation').addClass('has-error').removeClass('has-success');

      },
      unhighlight: function(element, errorClass) {
        $(element).parents('.validation').removeClass('has-error').addClass('has-success');

      }
    });
    $(function () {
        $('input[name=daterange]').daterangepicker({},
            function (_start, _end, label) {
                start = _start.format(format);
                end = _end.format(format);
            });
    });
    function formsubmit() {
        if (!$('form.form').valid()) {
          return false;
        }
        var name = document.getElementById('name').value;
        var place = document.getElementById('place').value;
        var total_time = document.getElementById('total_time').value;
        var take = document.getElementById('take').value;
        var pay = total_time * 6030;
        var total_pay = pay - take;
        var text = '제 이름은 name입니다.' +
            '저는 place에서 start부터 end까지 일을 했습니다. ' +
            '총 total_time시간을 일했으며 최저 임금이 6,030원이므로 pay원을 받야아 합니다. ' +
            '그런데 제가 받은 액수는 총 take원입니다. ' +
            '따라서 total_pay원을 place(으)로부터 받을 수 있도록 선처해주세요.';
        text = text.replace(/start/g, start);
        text = text.replace(/end/g, end);
        text = text.replace(/name/g, name);
        text = text.replace(/place/g, place);
        text = text.replace(/total_time/g, total_time);
        text = text.replace(/take/g, take);
        text = text.replace(/total_pay/g, total_pay);
        text = text.replace(/pay/g, pay);

        Cookies.set('text', text);
        Cookies.set('case', "case0");
        window.location.href = '/report/result';
        return false;
    }
</script>
{% endblock %}
